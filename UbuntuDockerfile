# Use an official Ubuntu as the base image
FROM ubuntu:20.04

ENV DEBIAN_FRONTEND=noninteractive

WORKDIR /app
# Update fedora
RUN apt-get update -y

# Install all sfml compilation libraries
RUN apt-get install -y  \
    apt-file            \
    g++                 \
    git                 \
    cmake               \
    x11-common          \
    libxrandr-dev       \
    libxcursor-dev      \
    libgl-dev           \
    libudev-dev         \
    libflac-dev         \
    libopenal-dev       \
    libvorbis-dev       \
    libfreetype-dev     \
    libfreetype6

RUN apt-file update

# Copy all necessaries dependencies
COPY ./CMakeLists.txt .
COPY ./cmake/ ./cmake/
COPY ./server/ ./server/
COPY ./client/ ./client/
COPY ./build_scripts/build_ubuntu_binary.sh .
COPY ./build_scripts/launch_client.sh .
COPY ./build_scripts/launch_server.sh .

# Run build script
RUN ./build_ubuntu_binary.sh
